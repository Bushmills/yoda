( tools for automated test suite )
loaded lest tests done  \ don't reload, reset error log instead
provides: tests check expected report
needs: red bg normal link

create errors 0 ,
create testcount 0 ,
random constant canary

: report  ( -- )
        "failed test(s): " type$
        errors
        begin @
        ?dup while
           dup cell+ @ u.
        repeat  ;

: tests    ( -- )
        errors off
        testcount off ;

: check    ( -- )
        errors @
        if     red bg report normal
        else  "No errors" type$
        then  cr   ;

: expected ( x1 x2 -- )
        testcount inc
        = unless
           errors link
           testcount @ ,  ;

